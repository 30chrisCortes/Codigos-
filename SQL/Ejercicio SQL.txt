---FACTURAS CUYO TOTAL SE IGUAL O SUPERIOR AL MONTO TOTAL PROMEDIO DE LAS FACTURAS 
---EMITIDAS EN EL MES DE ENERO Y QUE EL TOTAL DE UNIDADES COMPRADAS EN LA FACTURA SEA
---IGUAL O SUPERIOR A 10 UNIDADES.

---CASO 1
SELECT 
f.NUMFACTURA AS "NUM FACTURA",
f.RUTVENDEDOR AS "RUT VENDEDOR",
TO_CHAR(f.FECHA, 'dd "de" month" del" yyyy') AS "FECHA",
TO_CHAR(f.TOTAL, '$999G999G999') AS "MONTO FACTURA",
SUM(d.CANTIDAD) AS "CANTIDAD", 
NVL(b.DESCRIPCION, 'SIN BANCO') AS BANCO
FROM DETALLE_FACTURA d INNER JOIN FACTURA f
    ON(f.NUMFACTURA = d.NUMFACTURA)
LEFT JOIN BANCO b
    ON(f.codbanco = b.CODBANCO)
WHERE f.TOTAL >=(SELECT AVG(TOTAL)
                FROM FACTURA
                WHERE EXTRACT(MONTH FROM FECHA) =  1)
GROUP BY f.NUMFACTURA, f.RUTVENDEDOR, f.FECHA, f.TOTAL, b.DESCRIPCION
HAVING SUM(d.CANTIDAD) >= 10
ORDER BY 3;