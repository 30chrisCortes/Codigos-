--reporte que traiga el nobre concatenado, mas la profesion
--SOLO AQUELLOS DONDE GANEN MENOS QUE EL SUELDO PROMEDIO

SELECT *
FROM EMPLOYEES;

SELECT
e.FIRST_NAME||' '||e.LAST_NAME||' trabaja en '||
j.JOB_TITLE AS "NOMBRE Y PROFESION",
TO_CHAR(e.SALARY, '$999G999G999') AS "SALARIO"
FROM EMPLOYEES e
INNER JOIN JOBS j
    ON(e.JOB_ID = j.JOB_ID)
WHERE SALARY >= (SELECT AVG(SALARY) FROM EMPLOYEES)
ORDER BY 2 DESC;
    
-- EMPLEADOS QUE GANEN MENOS QUE EL SALARIO MINIMO PARA LUEGO ENTREGAR UN BONO.

SELECT
e.FIRST_NAME||' '||e.LAST_NAME||' trabaja en '||
j.JOB_TITLE AS "NOMBRE Y PROFESION",
TO_CHAR(e.SALARY, '$999G999G999') AS "SALARIO"
FROM EMPLOYEES e
INNER JOIN JOBS j
    ON(e.JOB_ID = j.JOB_ID)
WHERE SALARY <= (SELECT MIN(SALARY) FROM EMPLOYEES)
ORDER BY 2 DESC;

---MUESTRE LOS DEPTOS DONDE SUS EMPLEADOS POSEAN UN SALARIO
---MINIMO MAYOR AL SALARIO MINIMOS DEL DEPTO 80.

SELECT MIN(SALARY) FROM EMPLOYEES WHERE DEPARTMENT_ID = 80

SELECT 
EMPLOYEE_ID,
FIRST_NAME||' '|| LAST_NAME AS NOMBRE,
MIN(SALARY) AS "SALARIO MINIMO"
FROM EMPLOYEES
GROUP  BY EMPLOYEE_ID, FIRST_NAME, LAST_NAME
HAVING MIN(SALARY) > (SELECT MIN(SALARY) 
                        FROM EMPLOYEES 
                        WHERE DEPARTMENT_ID = 80)
-------------------------------------------------

--b
SELECT
EMPLOYEE_ID,
SALARY AS "SALARIO",
TO_CHAR(HIRE_DATE, 'dd/mm/yyyy') AS "FECHA CONTRATO",
TRUNC((SYSDATE - HIRE_DATE)) AS "DIAS TRABAJADOS",
ROUND(MONTHS_BETWEEN(SYSDATE, HIRE_DATE)) AS "MESES CONTRATADO",
(EXTRACT(YEAR FROM SYSDATE) - EXTRACT(YEAR FROM HIRE_DATE)) AS "AÃ‘OS CONTRATADO"
FROM EMPLOYEES
WHERE SALARY < (SELECT AVG(SALARY)
                FROM EMPLOYEES)
ORDER BY SALARY, EMPLOYEE_ID ASC;

--c
SELECT 
d.DEPARTMENT_NAME AS "DEPARTAMENTO",
COUNT(e.EMPLOYEE_ID) AS "NUMERO DE EMPLEADOS"
FROM EMPLOYEES e INNER JOIN DEPARTMENTS d
    ON (e.DEPARTMENT_ID = d.DEPARTMENT_ID)
GROUP BY d.DEPARTMENT_NAME
HAVING COUNT(e.EMPLOYEE_ID) = (SELECT 
                                MAX(COUNT(EMPLOYEE_ID))
                                FROM EMPLOYEES
                                GROUP BY DEPARTMENT_ID);